<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="bruges.rockphysics package" href="bruges.rockphysics.html" /><link rel="prev" title="bruges.petrophysics package" href="bruges.petrophysics.html" />

    <link rel="shortcut icon" href="_static/favicon.ico"/><meta name="generator" content="sphinx-4.4.0, furo 2022.02.14.1"/>
        <title>bruges.reflection package - bruges documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=a8f031f701c6af50c9919b48f173a5785af06fac" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">bruges  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/bruges_logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="bruges.html">bruges package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bruges.attribute.html">bruges.attribute package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.filters.html">bruges.filters package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.models.html">bruges.models package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.noise.html">bruges.noise package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.petrophysics.html">bruges.petrophysics package</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">bruges.reflection package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.rockphysics.html">bruges.rockphysics package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.transform.html">bruges.transform package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.unit.html">bruges.unit package</a></li>
<li class="toctree-l2"><a class="reference internal" href="bruges.util.html">bruges.util package</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/bruges/">PyPI releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/agile-geoscience/bruges">Code in GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/agile-geoscience/bruges/issues">Issue tracker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://code.agilescientific.com/community">Community guidelines</a></li>
<li class="toctree-l1"><a class="reference external" href="https://code.agilescientific.com">Agile's software</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.agilescientific.com">Agile's website</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="bruges-reflection-package">
<h1>bruges.reflection package<a class="headerlink" href="#bruges-reflection-package" title="Permalink to this headline">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-bruges.reflection.reflection">
<span id="bruges-reflection-reflection-module"></span><h2>bruges.reflection.reflection module<a class="headerlink" href="#module-bruges.reflection.reflection" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.acoustic_reflectivity">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">acoustic_reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#acoustic_reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.acoustic_reflectivity" title="Permalink to this definition">#</a></dt>
<dd><p>The acoustic reflectivity, given Vp and RHOB logs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>ndarray</em>) – The P-wave velocity.</p></li>
<li><p><strong>rho</strong> (<em>ndarray</em>) – The bulk density.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – The dimension along which to compute the reflectivity.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – ‘same’ means the output will be the same shape. ‘valid’
means that only strictly valid reflectivities are computed so
the result will be one sample shorted in the <cite>axis</cite> dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reflectivity coefficient series.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.akirichards">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">akirichards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#akirichards"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.akirichards" title="Permalink to this definition">#</a></dt>
<dd><p>The Aki-Richards approximation to the reflectivity.</p>
<p>This is the formulation from Avseth et al., Quantitative seismic
interpretation, Cambridge University Press, 2006. Adapted for a 4-term
formula. See <a class="reference external" href="http://subsurfwiki.org/wiki/Aki-Richards_equation">http://subsurfwiki.org/wiki/Aki-Richards_equation</a>.</p>
<p>Returns the complex reflectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>terms</strong> (<em>bool</em>) – Whether or not to return a tuple of the terms of the
equation. The first term is the acoustic impedance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The Aki-Richards approximation for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.akirichards_alt">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">akirichards_alt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#akirichards_alt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.akirichards_alt" title="Permalink to this definition">#</a></dt>
<dd><p>This is another formulation of the Aki-Richards solution.
See <a class="reference external" href="http://subsurfwiki.org/wiki/Aki-Richards_equation">http://subsurfwiki.org/wiki/Aki-Richards_equation</a></p>
<p>Returns the complex reflectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>terms</strong> (<em>bool</em>) – Whether or not to return a tuple of the terms of the
equation. The first term is the acoustic impedance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The Aki-Richards approximation for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.blangy">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">blangy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#blangy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.blangy" title="Permalink to this definition">#</a></dt>
<dd><p>Implements the Blangy equation with the same interface as the other
reflectivity equations. Wraps bruges.anisotropy.blangy(), which you may
prefer to use directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>d1</strong> (<em>ndarray</em>) – The upper delta; float or 1D array length m.</p></li>
<li><p><strong>e1</strong> (<em>ndarray</em>) – The upper epsilon; float or 1D array length m.</p></li>
<li><p><strong>d2</strong> (<em>ndarray</em>) – The lower delta; float or 1D array length m.</p></li>
<li><p><strong>e2</strong> (<em>ndarray</em>) – The lower epsilon; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The Blangy approximation for P-P reflectivity at the</dt><dd><p>interface. Wraps <cite>anisotropy.blangy()</cite>.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.bortfeld">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">bortfeld</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#bortfeld"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.bortfeld" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Bortfeld approximation with three terms.
<a class="reference external" href="http://sepwww.stanford.edu/public/docs/sep111/marie2/paper_html/node2.html">http://sepwww.stanford.edu/public/docs/sep111/marie2/paper_html/node2.html</a>
Real numbers only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>terms</strong> (<em>bool</em>) – Whether or not to return a tuple of the terms of the
equation. The first term is the acoustic impedance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The 3-term Bortfeld approximation for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.bortfeld2">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">bortfeld2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#bortfeld2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.bortfeld2" title="Permalink to this definition">#</a></dt>
<dd><p>The 2-term Bortfeld approximation for ava analysis. Wraps <cite>shuey()</cite>.
Deprecated, use <cite>bortfeld()</cite> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>terms</strong> (<em>bool</em>) – Whether or not to return a tuple of the terms of the
equation. The first term is the acoustic impedance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The 2-term Bortfeld approximation for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.bortfeld3">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">bortfeld3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#bortfeld3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.bortfeld3" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.critical_angles">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">critical_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#critical_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.critical_angles" title="Permalink to this definition">#</a></dt>
<dd><p>Compute critical angle at an interface</p>
<p>Given the upper (vp1) and lower (vp2) velocities at an interface. If you want the PS-wave critical angle as well,
pass vs2 as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – Upper layer P-wave velocity.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – Lower layer P-wave velocity.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – Lower layer S-wave velocity (optional).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>The first and second critical angles at the interface, in</dt><dd><p>degrees. If there isn’t a critical angle, it returns np.nan.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.fatti">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">fatti</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#fatti"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.fatti" title="Permalink to this definition">#</a></dt>
<dd><p>Compute reflectivities with Fatti’s formulation of the Aki-Richards
equation, which does not account for the critical angle. See Fatti et al.
(1994), Geophysics 59 (9). Real numbers only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>terms</strong> (<em>bool</em>) – Whether or not to return a tuple of the terms of the
equation. The first term is the acoustic impedance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The Fatti approximation for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.hilterman">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">hilterman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#hilterman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.hilterman" title="Permalink to this definition">#</a></dt>
<dd><p>Not recommended, only seems to match Zoeppritz to about 10 deg.</p>
<p>Hilterman (1989) approximation from Mavko et al. Rock Physics Handbook.
According to Dvorkin: “arguably the simplest and a very convenient
[approximation].” At least for small angles and small contrasts. Real
numbers only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>terms</strong> (<em>bool</em>) – Whether or not to return a tuple of the terms of the
equation. The first term is the acoustic impedance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The Hilterman approximation for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.preprocess">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.preprocess" title="Permalink to this definition">#</a></dt>
<dd><p>Decorator to preprocess arguments for the reflectivity equations.</p>
<p>Takes a reflectivity function requiring Vp, Vs, and RHOB for 2 rocks
(upper and lower), plus incidence angle theta, plus kwargs. Returns
that function with some arguments transformed.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.reflection_phase">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">reflection_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reflectivity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#reflection_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.reflection_phase" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the phase of the reflectivity. Returns an array (or float) of
the phase, in positive multiples of 180 deg or pi rad. So 1 is opposite
phase. A value of 1.1 would be +1.1         imes pi rad.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reflectivity</strong> (<em>ndarray</em>) – The reflectivity, eg from <cite>zoeppritz()</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The phase, strictly positive</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.reflectivity">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zoeppritz_rpp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'valid'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.reflectivity" title="Permalink to this definition">#</a></dt>
<dd><p>Offset reflectivity, given Vp, Vs, rho, and offset.</p>
<p>Computes ‘upper’ and ‘lower’ intervals from the three provided arrays,
then passes the result to the specified method to compute reflection
coefficients.</p>
<p>For acoustic reflectivity, either use the <cite>acoustic_reflectivity()</cite>
function, or call <cite>reflectivity()</cite> passing any log as Vs, e.g. just give
the Vp log twice (it won’t be used anyway):</p>
<blockquote>
<div><p>reflectivity(vp, vp, rho)</p>
</div></blockquote>
<p>For anisotropic reflectivity, use either <cite>anisotropy.blangy()</cite> or
<cite>anisotropy.ruger()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp</strong> (<em>ndarray</em>) – The P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs</strong> (<em>ndarray</em>) – The S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho</strong> (<em>ndarray</em>) – The density; float or 1D array length m.</p></li>
<li><p><strong>theta</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The reflectivity equation to use; one of:</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – The dimension along which to compute the reflectivity.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – <p>‘same’ means the output will be the same shape. ‘valid’
means that only strictly valid reflectivities are computed so
the result will be one sample shorted in the <cite>axis</cite> dimension.</p>
<blockquote>
<div><ul>
<li><p>’scattering_matrix’: scattering_matrix</p></li>
<li><p>’zoeppritz_element’: zoeppritz_element</p></li>
<li><p>’zoeppritz’: zoeppritz</p></li>
<li><p>’zoeppritz_rpp’: zoeppritz_rpp</p></li>
<li><p>’akirichards’: akirichards</p></li>
<li><p>’akirichards_alt’: akirichards_alt</p></li>
<li><p>’fatti’: fatti</p></li>
<li><p>’shuey’: shuey</p></li>
<li><p>’bortfeld’: bortfeld</p></li>
<li><p>’hilterman’: hilterman</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>Notes</strong> – <ul>
<li><p>scattering_matrix gives the full solution</p></li>
<li><p>zoeppritz_element gives a single element which you specify</p></li>
<li><p>zoeppritz returns RPP element only; use zoeppritz_rpp instead</p></li>
<li><p>zoeppritz_rpp is faster than zoeppritz or zoeppritz_element</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The result of running the specified method on the inputs.</dt><dd><p>Will be a float (for float inputs and one angle), a 1 x n array
(for float inputs and an array of angles), a 1 x m-1 array (for
float inputs and one angle), or an m-1 x n array (for array inputs
and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.scattering_matrix">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">scattering_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#scattering_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.scattering_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Full Zoeppritz solution, considered the definitive solution.
Calculates the angle dependent p-wave reflectivity of an interface
between two mediums.</p>
<p>Originally written by: Wes Hamlyn, vectorized by Agile.</p>
<p>Returns the complex reflectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>float</em>) – The upper P-wave velocity.</p></li>
<li><p><strong>vs1</strong> (<em>float</em>) – The upper S-wave velocity.</p></li>
<li><p><strong>rho1</strong> (<em>float</em>) – The upper layer’s density.</p></li>
<li><p><strong>vp2</strong> (<em>float</em>) – The lower P-wave velocity.</p></li>
<li><p><strong>vs2</strong> (<em>float</em>) – The lower S-wave velocity.</p></li>
<li><p><strong>rho2</strong> (<em>float</em>) – The lower layer’s density.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The exact Zoeppritz solution for all modes at the interface.</dt><dd><p>A 4x4 array representing the scattering matrix at the incident
angle theta1.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.shuey">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">shuey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#shuey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.shuey" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Shuey approximation with 3 terms.
<a class="reference external" href="http://subsurfwiki.org/wiki/Shuey_equation">http://subsurfwiki.org/wiki/Shuey_equation</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>terms</strong> (<em>bool</em>) – Whether or not to return a tuple of the terms of the
equation. The first term is the acoustic impedance.</p></li>
<li><p><strong>return_gradient</strong> (<em>bool</em>) – Whether to return a tuple of the intercept
and gradient (i.e. the second term divided by sin^2(theta)).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The Aki-Richards approximation for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.shuey2">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">shuey2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#shuey2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.shuey2" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Shuey approximation with 2 terms. Wraps <cite>shuey()</cite>. Deprecated,
use <cite>shuey()</cite> instead.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.shuey3">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">shuey3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#shuey3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.shuey3" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Shuey approximation with 3 terms. Wraps <cite>shuey()</cite>. Deprecated,
use <cite>shuey()</cite> instead.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.vectorize">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">vectorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#vectorize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.vectorize" title="Permalink to this definition">#</a></dt>
<dd><p>Decorator to make sure the inputs are arrays. We also add a dimension
to theta to make the functions work in an ‘outer product’ way.</p>
<p>Takes a reflectivity function requiring Vp, Vs, and RHOB for 2 rocks
(upper and lower), plus incidence angle theta, plus kwargs. Returns
that function with the arguments transformed to ndarrays.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.zoeppritz">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">zoeppritz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#zoeppritz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.zoeppritz" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the PP reflection coefficients from the Zoeppritz
scattering matrix. Wraps zoeppritz_element().</p>
<p>Returns the complex reflectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>float</em>) – The upper P-wave velocity.</p></li>
<li><p><strong>vs1</strong> (<em>float</em>) – The upper S-wave velocity.</p></li>
<li><p><strong>rho1</strong> (<em>float</em>) – The upper layer’s density.</p></li>
<li><p><strong>vp2</strong> (<em>float</em>) – The lower P-wave velocity.</p></li>
<li><p><strong>vs2</strong> (<em>float</em>) – The lower S-wave velocity.</p></li>
<li><p><strong>rho2</strong> (<em>float</em>) – The lower layer’s density.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. Array length n of the exact Zoeppritz solution for the</dt><dd><p>specified modes at the interface, at the incident angle theta1.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.zoeppritz_element">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">zoeppritz_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PdPu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#zoeppritz_element"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.zoeppritz_element" title="Permalink to this definition">#</a></dt>
<dd><p>Returns any mode reflection coefficients from the Zoeppritz
scattering matrix. Pass in the mode as element, e.g. ‘PdSu’ for PS.</p>
<p>Wraps scattering_matrix().</p>
<p>Returns the complex reflectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>float</em>) – The upper P-wave velocity.</p></li>
<li><p><strong>vs1</strong> (<em>float</em>) – The upper S-wave velocity.</p></li>
<li><p><strong>rho1</strong> (<em>float</em>) – The upper layer’s density.</p></li>
<li><p><strong>vp2</strong> (<em>float</em>) – The lower P-wave velocity.</p></li>
<li><p><strong>vs2</strong> (<em>float</em>) – The lower S-wave velocity.</p></li>
<li><p><strong>rho2</strong> (<em>float</em>) – The lower layer’s density.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
<li><p><strong>element</strong> (<em>str</em>) – The name of the element to return, must be one of:
‘PdPu’, ‘SdPu’, ‘PuPu’, ‘SuPu’, ‘PdSu’, ‘SdSu’, ‘PuSu’, ‘SuSu’,
‘PdPd’, ‘SdPd’, ‘PuPd’, ‘SuPd’, ‘PdSd’, ‘SdSd’, ‘PuSd’, ‘SuSd’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. Array length n of the exact Zoeppritz solution for the</dt><dd><p>specified modes at the interface, at the incident angle theta1.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="bruges.reflection.reflection.zoeppritz_rpp">
<span class="sig-prename descclassname"><span class="pre">bruges.reflection.reflection.</span></span><span class="sig-name descname"><span class="pre">zoeppritz_rpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bruges/reflection/reflection.html#zoeppritz_rpp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bruges.reflection.reflection.zoeppritz_rpp" title="Permalink to this definition">#</a></dt>
<dd><p>Exact Zoeppritz from expression.</p>
<p>This is useful because we can pass arrays to it, which we can’t do to
scattering_matrix().</p>
<p>Dvorkin et al. (2014). Seismic Reflections of Rock Properties. Cambridge.</p>
<p>Returns the complex reflectivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vp1</strong> (<em>ndarray</em>) – The upper P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs1</strong> (<em>ndarray</em>) – The upper S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho1</strong> (<em>ndarray</em>) – The upper layer’s density; float or 1D array length m.</p></li>
<li><p><strong>vp2</strong> (<em>ndarray</em>) – The lower P-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>vs2</strong> (<em>ndarray</em>) – The lower S-wave velocity; float or 1D array length m.</p></li>
<li><p><strong>rho2</strong> (<em>ndarray</em>) – The lower layer’s density; float or 1D array length m.</p></li>
<li><p><strong>theta1</strong> (<em>ndarray</em>) – The incidence angle; float or 1D array length n.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ndarray. The exact Zoeppritz solution for P-P reflectivity at the</dt><dd><p>interface. Will be a float (for float inputs and one angle), a
1 x n array (for float inputs and an array of angles), a 1 x m
array (for float inputs and one angle), or an n x m array (for
array inputs and an array of angles).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-bruges.reflection">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bruges.reflection" title="Permalink to this headline">#</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="bruges.rockphysics.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">bruges.rockphysics package</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="bruges.petrophysics.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">bruges.petrophysics package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Agile Scientific
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">bruges.reflection package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-bruges.reflection.reflection">bruges.reflection.reflection module</a></li>
<li><a class="reference internal" href="#module-bruges.reflection">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>