<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="bruges package" href="../api/bruges.html" /><link rel="prev" title="Wedge models" href="Wedge_models.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><meta name="generator" content="sphinx-4.5.0, furo 2022.04.07"/>
        <title>Seismic attributes - bruges documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=68f4518137b9aefe99b631505a2064c3c42c9852" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">bruges  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/bruges_logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quick_start_wedge.html">Welcome to <code class="docutils literal notranslate"><span class="pre">bruges</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Making_wavelets.html">Making wavelets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Wedge_models.html">Wedge models</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Seismic attributes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/bruges.html">bruges package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.attribute.html">bruges.attribute package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.filters.html">bruges.filters package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.models.html">bruges.models package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.noise.html">bruges.noise package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.petrophysics.html">bruges.petrophysics package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.reflection.html">bruges.reflection package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.rockphysics.html">bruges.rockphysics package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.transform.html">bruges.transform package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.unit.html">bruges.unit package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bruges.util.html">bruges.util package</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html#id1">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/bruges/">PyPI releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/agilescientific/bruges">Code in GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/agilescientific/bruges/issues">Issue tracker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://code.agilescientific.com/community">Community guidelines</a></li>
<li class="toctree-l1"><a class="reference external" href="https://code.agilescientific.com">Agile's software</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.agilescientific.com">Agile's website</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="seismic-attributes">
<h1>Seismic attributes<a class="headerlink" href="#seismic-attributes" title="Permalink to this headline">#</a></h1>
<p>We’ll make some seismic attributes in <code class="docutils literal notranslate"><span class="pre">bruges</span></code>. I am going to use a very narrow 3D volume from <a class="reference external" href="https://terranubis.com/datainfo/F3-Demo-2020">the F3 seismic dataset</a> (CC BY-SA 3.0) so that the dataset is not too big.</p>
<p>We’ll look at:</p>
<ul class="simple">
<li><p>Complex trace attributes like reflection strength.</p></li>
<li><p>Semblance attributes.</p></li>
<li><p>Windowed attributes (not actually using <code class="docutils literal notranslate"><span class="pre">bruges</span></code>, but SciPy directly).</p></li>
</ul>
<p>In general <code class="docutils literal notranslate"><span class="pre">bruges</span></code> is not yet directly compatible with <code class="docutils literal notranslate"><span class="pre">xarray</span></code>’s objects. You can always pass the internal NumPy data from an <code class="docutils literal notranslate"><span class="pre">xarray.DataAarray</span></code> called <code class="docutils literal notranslate"><span class="pre">x</span></code> like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>x.data
</pre></div>
</div>
<p>So it shouldn’t cause too many problems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">seismic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'../data/F3_seismic.npy'</span><span class="p">)</span>
    
<span class="n">seismic</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10, 250, 463)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">seismic</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fd9fc865ea0&gt;
</pre></div>
</div>
<img alt="../_images/Seismic_attributes_2_1.png" src="../_images/Seismic_attributes_2_1.png"/>
</div>
</div>
<section id="complex-trace-attributes">
<h2>Complex trace attributes<a class="headerlink" href="#complex-trace-attributes" title="Permalink to this headline">#</a></h2>
<section id="envelope-aka-reflection-strength-instantaneous-amplitude">
<h3>Envelope (aka reflection strength, instantaneous amplitude)<a class="headerlink" href="#envelope-aka-reflection-strength-instantaneous-amplitude" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bruges</span> <span class="k">as</span> <span class="nn">bg</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">envelope</span><span class="p">(</span><span class="n">seismic</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'bicubic'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fd9e7aee410&gt;
</pre></div>
</div>
<img alt="../_images/Seismic_attributes_5_1.png" src="../_images/Seismic_attributes_5_1.png"/>
</div>
</div>
</section>
<section id="instantaneous-phase">
<h3>Instantaneous phase<a class="headerlink" href="#instantaneous-phase" title="Permalink to this headline">#</a></h3>
<p>We’ll display this with a circular colourmap, and turn off interpolation to preven visualization artifacts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">instantaneous_phase</span><span class="p">(</span><span class="n">seismic</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">phase</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'twilight_shifted'</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'none'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fd9e7b6dab0&gt;
</pre></div>
</div>
<img alt="../_images/Seismic_attributes_7_1.png" src="../_images/Seismic_attributes_7_1.png"/>
</div>
</div>
</section>
<section id="instantaneous-frequency">
<h3>Instantaneous frequency<a class="headerlink" href="#instantaneous-frequency" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">instantaneous_frequency</span><span class="p">(</span><span class="n">seismic</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.004</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">freq</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'bicubic'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7fd9e79a8a90&gt;
</pre></div>
</div>
<img alt="../_images/Seismic_attributes_9_1.png" src="../_images/Seismic_attributes_9_1.png"/>
</div>
</div>
</section>
<section id="similarity-family-including-coherency-semblance-gradient-structure-tensor-etc">
<h3>Similarity (family including coherency, semblance, gradient structure tensor, etc.)<a class="headerlink" href="#similarity-family-including-coherency-semblance-gradient-structure-tensor-etc" title="Permalink to this headline">#</a></h3>
<p>⚠️ This one takes quite a bit longer than the simpler attributes above (about a minute on my machine), so you might want to experiment on a subcube before computing the entire volume.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">semb</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">seismic</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.004</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">'gst'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/bruges/attribute/discontinuity.py:77: RuntimeWarning: invalid value encountered in float_scalars
  return (eigs[0]-eigs[1]) / (eigs[0]+eigs[1])
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [6],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">semb</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">seismic</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">0.036</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.004</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">'gst'</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/bruges/attribute/discontinuity.py:124,</span> in <span class="ni">discontinuity</span><span class="nt">(traces, duration, dt, step_out, kind, sigma)</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span>     <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Expected 2D or 3D seismic data."</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span>     <span class="s2">"marfurt"</span><span class="p">:</span> <span class="n">moving_window</span><span class="p">(</span><span class="n">traces</span><span class="p">,</span> <span class="n">marfurt</span><span class="p">,</span> <span class="n">window</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span>     <span class="s2">"gersztenkorn"</span><span class="p">:</span> <span class="n">moving_window</span><span class="p">(</span><span class="n">traces</span><span class="p">,</span> <span class="n">gersztenkorn</span><span class="p">,</span> <span class="n">window</span><span class="p">),</span>
<span class="ne">--&gt; </span><span class="mi">124</span>     <span class="s2">"gst"</span><span class="p">:</span> <span class="n">gst_discontinuity</span><span class="p">(</span><span class="n">traces</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">methods</span><span class="p">[</span><span class="n">kind</span><span class="p">])</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/bruges/attribute/discontinuity.py:89,</span> in <span class="ni">gst_discontinuity</span><span class="nt">(seismic, window, sigma)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span> <span class="sd">"""</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span><span class="sd"> Gradient structure tensor discontinuity.</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span><span class="sd"> SEG, Expanded Abstracts, 668-671.</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span><span class="sd"> """</span>
<span class="g g-Whitespace">     </span><span class="mi">88</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">gradients</span><span class="p">(</span><span class="n">seismic</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">89</span> <span class="k">return</span> <span class="n">moving_window4d</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">gst_calc</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/bruges/attribute/discontinuity.py:69,</span> in <span class="ni">moving_window4d</span><span class="nt">(grad, window, func)</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>     <span class="n">region</span> <span class="o">=</span> <span class="n">padded</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">window</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="n">window</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">:]</span>
<span class="ne">---&gt; </span><span class="mi">69</span>     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="k">return</span> <span class="n">out</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/bruges/attribute/discontinuity.py:76,</span> in <span class="ni">gst_calc</span><span class="nt">(region)</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="n">region</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span> <span class="n">gst</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">76</span> <span class="n">eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">(</span><span class="n">gst</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span> <span class="k">return</span> <span class="p">(</span><span class="n">eigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">eigs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">eigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">eigs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="nn">File &lt;__array_function__ internals&gt;:180,</span> in <span class="ni">eigvalsh</span><span class="nt">(*args, **kwargs)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/linalg/linalg.py:1151,</span> in <span class="ni">eigvalsh</span><span class="nt">(a, UPLO)</span>
<span class="g g-Whitespace">   </span><span class="mi">1148</span> <span class="k">if</span> <span class="n">UPLO</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'L'</span><span class="p">,</span> <span class="s1">'U'</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1149</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"UPLO argument must be 'L' or 'U'"</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1151</span> <span class="n">extobj</span> <span class="o">=</span> <span class="n">get_linalg_error_extobj</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1152</span>     <span class="n">_raise_linalgerror_eigenvalues_nonconvergence</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1153</span> <span class="k">if</span> <span class="n">UPLO</span> <span class="o">==</span> <span class="s1">'L'</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1154</span>     <span class="n">gufunc</span> <span class="o">=</span> <span class="n">_umath_linalg</span><span class="o">.</span><span class="n">eigvalsh_lo</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.4/x64/lib/python3.10/site-packages/numpy/linalg/linalg.py:107,</span> in <span class="ni">get_linalg_error_extobj</span><span class="nt">(callback)</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span> <span class="k">def</span> <span class="nf">get_linalg_error_extobj</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">107</span>     <span class="n">extobj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_linalg_error_extobj</span><span class="p">)</span>  <span class="c1"># make a copy</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="n">extobj</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">return</span> <span class="n">extobj</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">semb</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'bicubic'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f415aeb73a0&gt;
</pre></div>
</div>
<img alt="../_images/Seismic_attributes_12_1.png" src="../_images/Seismic_attributes_12_1.png"/>
</div>
</div>
</section>
</section>
<section id="windowed-attribute-statistics">
<h2>Windowed attribute statistics<a class="headerlink" href="#windowed-attribute-statistics" title="Permalink to this headline">#</a></h2>
<p>Let’s say we’d like to compute the mean amplitude over a dataset, but inside a running window.</p>
<p>The easiest way to accomplish this is with <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.generic_filter()</span></code>. It’s nice because it handles the mechanics of stepping over the array.</p>
<p>This wants a so-called ‘callback’ function, to which each sub-volume will be passed. Let’s see:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rms</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Root mean square.</span>
<span class="sd">    </span>
<span class="sd">    Example</span>
<span class="sd">    &gt;&gt;&gt; rms([3, 4, 5])</span>
<span class="sd">    4.08248290463863</span>
<span class="sd">    """</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">generic_filter</span></code></strong> wants the data, the function, and the <strong><code class="docutils literal notranslate"><span class="pre">size</span></code></strong> of the sub-volume to pass in to the callback function. This can be trace-by-trace (use <strong>1</strong> for the first two dimensions) or multi-trace (e.g. use 3). A larger template will be slower to compute of course.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">generic_filter</span>

<span class="n">seismic_rms</span> <span class="o">=</span> <span class="n">generic_filter</span><span class="p">(</span><span class="n">seismic</span><span class="p">,</span> <span class="n">rms</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">seismic_rms</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(225, 300, 463)
</pre></div>
</div>
</div>
</div>
<p>The shape is the same as the original dataset. That’s convenient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">seismic_rms</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f79a06411c0&gt;
</pre></div>
</div>
<img alt="../_images/Seismic_attributes_18_1.png" src="../_images/Seismic_attributes_18_1.png"/>
</div>
</div>
<section id="other-statistics">
<h3>Other statistics<a class="headerlink" href="#other-statistics" title="Permalink to this headline">#</a></h3>
<p>To get other statistics, we just need to change the function, or simply pass in a function from NumPy or wherever, eg:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">seismic_median</span> <span class="o">=</span> <span class="n">generic_filter</span><span class="p">(</span><span class="n">seismic</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
</pre></div>
</div>
<p>Gives a median filter computed over a kernel with shape 3 × 3 inlines by crosslines, and 11 time samples.</p>
</section>
<section id="faster-but-fiddly-er">
<h3>Faster, but fiddly-er<a class="headerlink" href="#faster-but-fiddly-er" title="Permalink to this headline">#</a></h3>
<p>For the trace-by-trace case, we could speed this up by computing the RMS over various shifted versions of the seismic. This does not need more memory, because the shifted cubes are just views of the data. However, it does mean that the result will be shorter than the input, unless we somehow deal with the boundaries.</p>
<p>For a window of length <code class="docutils literal notranslate"><span class="pre">n</span></code>, we can make a set of shifted views of the volume:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">vols</span> <span class="o">=</span> <span class="p">[</span><span class="n">seismic</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ni</span><span class="p">:</span><span class="n">ni</span><span class="o">-</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Then compute the RMS over this collection; on my computer this is about 200 times faster than the <code class="docutils literal notranslate"><span class="pre">generic_filter</span></code> approach above (900 ms vs 3 minutes):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">vols</span><span class="p">)</span>
<span class="n">seismic_rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the result is not the same shape as the data, however:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seismic_rms</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(225, 300, 452)
</pre></div>
</div>
</div>
</div>
<p>Note that this volume has 5 samples ‘missing’ at the top, and another 5 at the bottom.</p>
<p>Also, this method won’t work for multi-trace statistics. So <code class="docutils literal notranslate"><span class="pre">generic_filter</span></code> is probably the best general approach.</p>
</section>
</section>
<section id="attributes-and-xarray">
<h2>Attributes and <code class="docutils literal notranslate"><span class="pre">xarray</span></code><a class="headerlink" href="#attributes-and-xarray" title="Permalink to this headline">#</a></h2>
<p>Let’s look at how to make this into an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="c1"># I don't have the inline, xline numbers, so I'll just use the shape.</span>
<span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">shape</span>
<span class="n">iline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">twt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.004</span>

<span class="n">env_xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">env</span><span class="p">,</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">'envelope'</span><span class="p">,</span>
                      <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">iline</span><span class="p">,</span> <span class="n">xline</span><span class="p">,</span> <span class="n">twt</span><span class="p">],</span>
                      <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">'iline'</span><span class="p">,</span> <span class="s1">'xline'</span><span class="p">,</span> <span class="s1">'twt'</span><span class="p">],</span>
                      <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This makes lots of things easier, like plotting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">env_xr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="s1">'upper'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f18c79ab730&gt;
</pre></div>
</div>
<img alt="../_images/Seismic_attributes_31_1.png" src="../_images/Seismic_attributes_31_1.png"/>
</div>
</div>
<hr class="docutils"/>
<p>© Agile Scientific 2021 — licensed CC BY / Apache 2.0</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../api/bruges.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">bruges package</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Wedge_models.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Wedge models</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, The Bruges Authors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://code.agilescientific.com" aria-label="Agile">
                <svg width="200" height="200" version="1.1" viewBox="0 0 187.5 187.5" xmlns="http://www.w3.org/2000/svg">
                <g transform="matrix(3.94 -1.28 1.28 3.94 -906.1 -3676)" style="color-rendering:auto;color:#000000;fill:#14ca29;image-rendering:auto;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;stroke-width:1px;text-decoration-color:#000000;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-transform:none;white-space:normal">
                <path d="m-46.98 936.1q3.515-1.622 6.705-3.244t5.083-2.379 3.028-0.757q1.893 0 3.244 1.298 1.406 1.244 1.406 3.136 0 1.081-0.7029 2.271-0.6489 1.136-1.406 1.46-6.975 2.758-15.36 4.001 1.514 1.406 3.731 3.731t2.325 2.487q0.8111 1.136 2.271 2.812 1.46 1.676 2.001 2.65 0.5948 0.9192 0.5948 2.271 0 1.73-1.298 3.028t-3.352 1.298q-2.055 0-4.65-3.19-2.541-3.19-6.597-11.46-4.109 7.462-5.515 9.841t-2.704 3.623q-1.298 1.19-2.974 1.19-2.001 0-3.352-1.352-1.298-1.406-1.298-2.974 0-1.46 0.5407-2.217 4.975-6.759 10.38-11.73-4.542-0.7029-8.111-1.568t-7.57-2.541q-0.6489-0.3244-1.298-1.46-0.5948-1.19-0.5948-2.163 0-1.893 1.352-3.136 1.406-1.298 3.19-1.298 1.298 0 3.244 0.8111 1.947 0.757 4.921 2.271 3.028 1.46 6.867 3.298-0.7029-3.407-1.19-7.786-0.4326-4.434-0.4326-6.056 0-2.001 1.244-3.407 1.298-1.46 3.298-1.46 1.947 0 3.19 1.46 1.298 1.406 1.298 3.785 0 0.6489-0.2163 2.595-0.1622 1.893-0.5407 4.65-0.3244 2.704-0.757 6.218z" style="fill:#14ca29"/>
                </g>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Seismic attributes</a><ul>
<li><a class="reference internal" href="#complex-trace-attributes">Complex trace attributes</a><ul>
<li><a class="reference internal" href="#envelope-aka-reflection-strength-instantaneous-amplitude">Envelope (aka reflection strength, instantaneous amplitude)</a></li>
<li><a class="reference internal" href="#instantaneous-phase">Instantaneous phase</a></li>
<li><a class="reference internal" href="#instantaneous-frequency">Instantaneous frequency</a></li>
<li><a class="reference internal" href="#similarity-family-including-coherency-semblance-gradient-structure-tensor-etc">Similarity (family including coherency, semblance, gradient structure tensor, etc.)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#windowed-attribute-statistics">Windowed attribute statistics</a><ul>
<li><a class="reference internal" href="#other-statistics">Other statistics</a></li>
<li><a class="reference internal" href="#faster-but-fiddly-er">Faster, but fiddly-er</a></li>
</ul>
</li>
<li><a class="reference internal" href="#attributes-and-xarray">Attributes and <code class="docutils literal notranslate"><span class="pre">xarray</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    </body>
</html>